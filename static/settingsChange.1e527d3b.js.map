{"version":3,"sources":["pages/settingsChange.ts"],"names":[],"mappings":"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","file":"settingsChange.1e527d3b.js","sourceRoot":"..\\src","sourcesContent":["import Block from \"../framework/block\";\nimport FormValidator from \"../framework/formValidator\";\nimport HTTPTransport from \"../framework/http\";\nimport Button from \"../components/button\";\n\nconst http = new HTTPTransport();\n\nconst button = new Button({\n  name: \"ButtonSaveAccount\",\n  blockClass: \"profile__wrapper-submit\",\n  props: {\n    type: 'submit',\n    text: 'Сохранить',\n    classButton: 'profile__btn-submit'\n  }\n});\n\nimport '../assets/css/settings.scss'\n\n\nclass SettingsChange extends Block {\n  private formValidator: FormValidator;\n  constructor({ root }) {\n    super({\n      name: \"settingsChange\",\n      tagName: \"section\",\n      components: {\n        button\n      },\n      blockClass: \"settings\",\n      root: root\n    });\n\n    this.formValidator = null;\n  }\n  render() {\n    return `\n      <h2 class=\"visually-hidden\">Профиль</h2>\n      <a class=\"settings__link-to-chats\" href=\"#chat_list\">Вернуться к списку чатов</a>\n      <form class=\"settings__profile  profile\" method=\"post\" name=\"settings-change\">\n        <label class=\"profile__label-avatar\" for=\"avatar\">Загрузить фотографию</label>\n        <input class=\"profile__upload-avatar\" type=\"file\" id=\"avatar\" name=\"avatar\">\n        <b class=\"profile__preview-name\">Иван</b>\n        <ul class=\"profile__list\">\n          <li class=\"profile__list-item\">\n            <label class=\"profile__form-item-label\">\n              Почта\n              <input class=\"profile__form-input\" type=\"email\" name=\"email\" value=\"pochta@yandex.ru\" pattern=\"[a-z0-9._%+-]+@[a-z0-9.-]+\\\\.[a-z]{2,4}$\">\n            </label>\n          </li>\n          <li class=\"profile__list-item\">\n            <label class=\"profile__form-item-label\">\n              Логин\n              <input class=\"profile__form-input\" type=\"text\" name=\"login\" value=\"ivanivanov\" minlength=\"4\" maxlength=\"24\" pattern=\"[a-zA-Z0-9]{4,24}\">\n            </label>\n          </li>\n          <li class=\"profile__list-item\">\n            <label class=\"profile__form-item-label\">\n              Имя\n              <input class=\"profile__form-input\" type=\"text\" name=\"first_name\" value=\"Иван\" minlength=\"4\" maxlength=\"24\">\n            </label>\n          </li>\n          <li class=\"profile__list-item\">\n            <label class=\"profile__form-item-label\">\n              Фамилия\n              <input class=\"profile__form-input\" type=\"text\" name=\"second_name\" value=\"Иванов\" minlength=\"4\" maxlength=\"24\">\n            </label>\n          </li>\n          <li class=\"profile__list-item\">\n            <label class=\"profile__form-item-label\">\n              Имя в чате\n              <input class=\"profile__form-input\" type=\"text\" name=\"display_name\" value=\"Иван\" minlength=\"4\" maxlength=\"24\">\n            </label>\n          </li>\n          <li class=\"profile__list-item\">\n            <label class=\"profile__form-item-label\">\n              Телефон\n              <input class=\"profile__form-input\" type=\"tel\" name=\"phone\" value=\"+7 (909) 967 30 30\" pattern=\"[+]7 [(]{1}[0-9]{3}[)]{1} [0-9]{3} [0-9]{2} [0-9]{2}$\" required>\n            </label>\n          </li>\n        </ul>\n        {{button}}\n      </form>\n    `;\n  }\n  componentMounted() {\n    document.title = \"Settings change\";\n\n    function tryToChangeSettings(formData) {\n      const formDataAsObject = {};\n      formData.forEach((value, prop) => {formDataAsObject[prop] = value});\n      return http.put(\n        'https://ya-praktikum.tech/api/v2/user/profile',\n        {\n          body: JSON.stringify(formDataAsObject),\n          headers: {\n            accept: 'application/json',\n            'Content-Type': 'application/json',\n          }\n        },\n        4000\n      );\n    }\n\n    this.root.nextTick(() => {\n      const form:HTMLFormElement = document.querySelector(\"form[name=settings-change]\");\n\n      function errorHandler(error): void {\n        console.warn('errorHandler', error);\n      }\n\n      function successHandler () {\n        const formData = new FormData(form)\n        tryToChangeSettings(formData).then().catch((reason) => {\n          console.warn(reason);\n        })\n      }\n\n      if (!form) {\n        errorHandler(\"Form is not found\");\n      } else {\n        this.formValidator = new FormValidator(form, successHandler, errorHandler);\n        this.formValidator.init()\n      }\n\n    });\n\n  }\n  componentDestroy(): void {\n    try {\n      this.formValidator.destroy()\n    } catch (e) {\n      console.warn(\"missing formValidator\", e)\n    }\n  }\n}\n\nexport default SettingsChange\n"]}